-- Add new schema named "java"
CREATE SCHEMA "java";
-- Add new schema named "vulnerabilities"
CREATE SCHEMA "vulnerabilities";
-- Create "callables" table
CREATE TABLE "java"."callables" ("id" bigserial NOT NULL, "fasten_id" character varying NOT NULL, "package_name" character varying(255) NOT NULL, "class_name" character varying(255) NOT NULL, "method_name" character varying(255) NOT NULL, "creation_time" timestamptz NOT NULL DEFAULT now(), PRIMARY KEY ("id"));
-- Create index "fasten_id" to table: "callables"
CREATE UNIQUE INDEX "fasten_id" ON "java"."callables" ("fasten_id");
-- Create "dependencies" table
CREATE TABLE "java"."dependencies" ("id" bigserial NOT NULL, "group" character varying NOT NULL, "name" character varying NOT NULL, "version" character varying(255) NOT NULL, "creation_time" timestamptz NOT NULL DEFAULT now(), "vulnerability_update_time" timestamptz NOT NULL DEFAULT now(), PRIMARY KEY ("id"));
-- Create index "depenedency_maven_coordinates" to table: "dependencies"
CREATE UNIQUE INDEX "depenedency_maven_coordinates" ON "java"."dependencies" ("group", "name", "version");
-- Create "vulnerabilities" table
CREATE TABLE "vulnerabilities"."vulnerabilities" ("id" bigserial NOT NULL, "external_id" character varying(255) NOT NULL, "severity" character varying(255) NULL, "creation_time" timestamptz NOT NULL DEFAULT now(), PRIMARY KEY ("id"), CONSTRAINT "severity" CHECK ((severity)::text = ANY (ARRAY[('LOW'::character varying)::text, ('MODERATE'::character varying)::text, ('MEDIUM'::character varying)::text, ('HIGH'::character varying)::text, ('CRITICAL'::character varying)::text])));
-- Create index "external_id" to table: "vulnerabilities"
CREATE UNIQUE INDEX "external_id" ON "vulnerabilities"."vulnerabilities" ("external_id");
-- Create "callables_vulnerabilities" table
CREATE TABLE "java"."callables_vulnerabilities" ("callable_id" bigint NOT NULL, "vulnerability_id" bigint NOT NULL, PRIMARY KEY ("callable_id", "vulnerability_id"), CONSTRAINT "callables_fk" FOREIGN KEY ("callable_id") REFERENCES "java"."callables" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "vulnerability_fk" FOREIGN KEY ("vulnerability_id") REFERENCES "vulnerabilities"."vulnerabilities" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
