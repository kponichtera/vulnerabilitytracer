package callables

import (
	"context"

	"vulnerabilitytracer/pkg/maven"
	"vulnerabilitytracer/pkg/vulnerabilities"
)

type DependencyProcessingStatus int

const (
	Processed DependencyProcessingStatus = iota
	Processing
	Unknown
)

type JavaCallable struct {
	ExternalID  string
	PackageName string
	ClassName   string
	MethodName  string
}

type JavaCallableRepository interface {
	GetDependencyProcessingStatus(ctx context.Context, coordinates maven.Coordinates) (DependencyProcessingStatus, error)
	GetVulnerableCallablesForDependency(ctx context.Context, coordinates maven.Coordinates) (map[vulnerabilities.Vulnerability][]JavaCallable, error)
}
