package vulnerabilities

import "vulnerabilitytracer/api/generated/coordinatorapi"

type Severity string

const (
	SeverityUndefined Severity = "UNDEFINED"
	SeverityLow       Severity = "LOW"
	SeverityModerate  Severity = "MODERATE"
	SeverityMedium    Severity = "MEDIUM"
	SeverityHigh      Severity = "HIGH"
	SeverityCritical  Severity = "CRITICAL"
)

type Vulnerability struct {
	ExternalID string
	Severity   Severity
}

func ConvertEnumToAPISeverity(severity Severity) coordinatorapi.VulnerabilitySeverity {
	return ConvertStringToAPISeverity(string(severity))
}

func ConvertStringToAPISeverity(severity string) coordinatorapi.VulnerabilitySeverity {
	switch severity {
	case "CRITICAL":
		return coordinatorapi.CRITICAL
	case "HIGH":
		return coordinatorapi.HIGH
	case "MEDIUM":
		return coordinatorapi.MEDIUM
	case "MODERATE":
		return coordinatorapi.MODERATE
	case "LOW":
		return coordinatorapi.LOW
	default:
		return coordinatorapi.UNDEFINED
	}
}
