package vulnerabilities

import "vulnerabilitytracer/api/generated/api"

type Severity string

const (
	SeverityUndefined Severity = "UNDEFINED"
	SeverityLow       Severity = "LOW"
	SeverityModerate  Severity = "MODERATE"
	SeverityMedium    Severity = "MEDIUM"
	SeverityHigh      Severity = "HIGH"
	SeverityCritical  Severity = "CRITICAL"
)

type Vulnerability struct {
	ExternalID string
	Severity   Severity
}

func ConvertEnumToAPISeverity(severity Severity) api.VulnerabilityMetadataSeverity {
	return ConvertStringToAPISeverity(string(severity))
}

func ConvertStringToAPISeverity(severity string) api.VulnerabilityMetadataSeverity {
	switch severity {
	case "CRITICAL":
		return api.CRITICAL
	case "HIGH":
		return api.HIGH
	case "MEDIUM":
		return api.MEDIUM
	case "MODERATE":
		return api.MODERATE
	case "LOW":
		return api.LOW
	default:
		return api.UNDEFINED
	}
}
