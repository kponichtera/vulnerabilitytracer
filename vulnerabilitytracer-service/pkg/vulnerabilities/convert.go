package vulnerabilities

import (
	"vulnerabilitytracer/api/generated/coordinatorapi"
	"vulnerabilitytracer/db/generated/queries"
)

func ConvertEnumToAPISeverity(severity Severity) coordinatorapi.VulnerabilitySeverity {
	return ConvertStringToAPISeverity(string(severity))
}

func ConvertStringToAPISeverity(severity string) coordinatorapi.VulnerabilitySeverity {
	switch severity {
	case "CRITICAL":
		return coordinatorapi.CRITICAL
	case "HIGH":
		return coordinatorapi.HIGH
	case "MEDIUM":
		return coordinatorapi.MEDIUM
	case "MODERATE":
		return coordinatorapi.MODERATE
	case "LOW":
		return coordinatorapi.LOW
	default:
		return coordinatorapi.UNDEFINED
	}
}

func ConvertDatabaseEnumToAPISeverity(severity queries.VulnerabilitiesSeverity) coordinatorapi.VulnerabilitySeverity {
	return ConvertStringToAPISeverity(string(severity))
}

func ConvertEnumToDatabaseEnum(severity Severity) queries.VulnerabilitiesSeverity {
	return ConvertStringToDatabaseEnum(string(severity))
}

func ConvertAPIStringToDatabaseEnum(severity coordinatorapi.VulnerabilitySeverity) queries.VulnerabilitiesSeverity {
	return ConvertStringToDatabaseEnum(string(severity))
}

func ConvertStringToDatabaseEnum(severity string) queries.VulnerabilitiesSeverity {
	switch severity {
	case "CRITICAL":
		return queries.VulnerabilitiesSeverityCRITICAL
	case "HIGH":
		return queries.VulnerabilitiesSeverityHIGH
	case "MEDIUM":
		return queries.VulnerabilitiesSeverityMEDIUM
	case "MODERATE":
		return queries.VulnerabilitiesSeverityMODERATE
	case "LOW":
		return queries.VulnerabilitiesSeverityLOW
	default:
		return queries.VulnerabilitiesSeverityUNDEFINED
	}
}
