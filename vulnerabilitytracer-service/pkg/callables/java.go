package callables

import (
	"context"

	"vulnerabilitytracer-service/api/generated/api"

	"vulnerabilitytracer-service/pkg/maven"
	"vulnerabilitytracer-service/pkg/vulnerabilities"
)

type JavaCallable struct {
	ExternalID  string
	PackageName string
	ClassName   string
	MethodName  string
}

type JavaCallableRepository interface {
	GetVulnerableCallablesForDependency(ctx context.Context, coordinates maven.Coordinates) (map[vulnerabilities.Vulnerability][]JavaCallable, error)
}

func ConvertToAPICallable(callable JavaCallable, mitigationStrategy api.JavaCallableMitigationStrategy) api.JavaCallable {
	return api.JavaCallable{
		ClassName:          callable.ClassName,
		MethodName:         callable.MethodName,
		PackageName:        callable.PackageName,
		MitigationStrategy: mitigationStrategy,
	}
}
