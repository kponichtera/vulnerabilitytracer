package tracegraph

import (
	"time"

	"github.com/dominikbraun/graph"
	"github.com/google/uuid"
)

type (
	NodeID = string
	Graph  = graph.Graph[NodeID, Node]
)

type Node struct {
	ID          NodeID
	ServiceName string
	UUID        uuid.UUID
	Events      []Event
}

type Event struct {
	VulnerabilityExternalID string
	CallableFastenID        string
	TriggerTime             time.Time
	MitigationStrategy      string
	Severity                string
}

func New() Graph {
	return graph.New(graphHashFunc, graph.Directed(), graph.Rooted())
}

func graphHashFunc(node Node) NodeID {
	return node.ID
}
