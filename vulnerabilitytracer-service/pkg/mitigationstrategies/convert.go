package mitigationstrategies

import (
	"vulnerabilitytracer/api/generated/coordinatorapi"
	"vulnerabilitytracer/db/generated/queries"
)

func ConvertStringToAPIMitigationStrategy(strategy *string) coordinatorapi.MitigationStrategy {
	if strategy == nil {
		return coordinatorapi.NONE
	}

	switch *strategy {
	case "ERROR":
		return coordinatorapi.ERROR
	case "NOOP":
		return coordinatorapi.NOOP
	default:
		return coordinatorapi.NONE
	}
}

func ConvertStringToDatabaseEnum(strategy *string) queries.ServiceMitigationStrategyType {
	if strategy == nil {
		return queries.ServiceMitigationStrategyTypeNONE
	}

	switch *strategy {
	case "ERROR":
		return queries.ServiceMitigationStrategyTypeERROR
	case "NOOP":
		return queries.ServiceMitigationStrategyTypeNOOP
	default:
		return queries.ServiceMitigationStrategyTypeNONE
	}
}

func ConvertAPIMitigationStrategyToDatabaseEnum(strategy *coordinatorapi.MitigationStrategy) queries.ServiceMitigationStrategyType {
	if strategy == nil {
		return queries.ServiceMitigationStrategyTypeNONE
	}

	return ConvertStringToDatabaseEnum((*string)(strategy))
}

func ConvertDatabaseEnumToAPIMitigationStrategy(strategy *queries.ServiceMitigationStrategyType) coordinatorapi.MitigationStrategy {
	if strategy == nil {
		return coordinatorapi.NONE
	}

	return ConvertStringToAPIMitigationStrategy((*string)(strategy))
}
