package nl.tudelft.kponichtera.thesis.vulnerabilitytracer.gradleplugin.service;

import nl.tudelft.kponichtera.thesis.vulnerabilitytracer.gradleplugin.report.VulnerabilityReport;
import nl.tudelft.kponichtera.thesis.vulnerabilitytracer.gradleplugin.utils.ReportMapperUtils;
import org.gradle.api.logging.Logger;

import java.io.File;
import java.io.IOException;

public class ReportPersistenceService {

    public static final String REPORT_FILENAME = "vulnerabilitytracer-report.json";

    private Logger logger;

    public ReportPersistenceService(Logger logger) {
        this.logger = logger;
    }

    public void saveReport(VulnerabilityReport report, File destinationDirectory) throws IOException {
        var reportFile = new File(destinationDirectory, REPORT_FILENAME);

        ReportMapperUtils.getMapper().writeValue(reportFile, report);
        logger.quiet("Saved report to {}", reportFile.getAbsolutePath());
    }

}
