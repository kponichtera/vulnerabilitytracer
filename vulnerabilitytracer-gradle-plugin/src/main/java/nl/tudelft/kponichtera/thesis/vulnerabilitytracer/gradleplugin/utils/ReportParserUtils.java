package nl.tudelft.kponichtera.thesis.vulnerabilitytracer.gradleplugin.utils;

import lombok.experimental.UtilityClass;
import nl.tudelft.kponichtera.thesis.vulnerabilitytracer.gradleplugin.report.DependencyCheckReport;
import org.gradle.api.Project;

@UtilityClass
public class ReportParserUtils {

    public static void readDependencies(Project project, DependencyCheckReport report) {
        var depsWithVulnerabilities = report.dependencies().stream()
                .filter(d -> d.vulnerabilities().isPresent())
                .toList();

        if (depsWithVulnerabilities.isEmpty()) {
            project.getLogger().lifecycle("No vulnerable dependencies found in the report");
            return;
        }

        project.getLogger().lifecycle("{} vulnerable dependencies found in the report");

    }

}
