version: 3

vars:
  KUBE_NAMESPACE: "{{.KUBE_NAMESPACE}}"

includes:
  fasten-api:
    taskfile: Taskfile-telepresence-intercept.yml
    vars:
      KUBE_SERVICE: "fasten-api"
      KUBE_SERVICE_PORT: "9080"
  vulnerabilitytracer-api:
    taskfile: Taskfile-telepresence-intercept.yml
    vars:
      KUBE_SERVICE: "vulnerabilitytracer-api"
      KUBE_SERVICE_PORT: "10420"

tasks:
  default: "telepresence {{.CLI_ARGS}}"
  connect: "telepresence connect --namespace {{ .KUBE_NAMESPACE }}"
  disconnect: "telepresence quit"
  stop: "telepresence quit --stop-daemons"