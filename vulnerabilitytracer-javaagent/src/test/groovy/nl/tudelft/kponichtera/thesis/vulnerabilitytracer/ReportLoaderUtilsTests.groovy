package nl.tudelft.kponichtera.thesis.vulnerabilitytracer


import nl.tudelft.kponichtera.thesis.vulnerabilitytracer.utils.ReportLoaderUtils
import spock.lang.Specification

class ReportLoaderUtilsTests extends Specification {

    def "example report parses correctly"() {
        setup:
        def reportFileResource = getClass().getClassLoader().getResource("vulnerabilitytracer-report.json")
        def reportFile = new File(reportFileResource.toURI())

        when:
        def report = ReportLoaderUtils.loadReport(reportFile)

        then:
        report != null
    }

    /**
     * The working directory should not have the vulnerabilitytracer-report.json file.
     * In this case, the test will pass.
     */
    def "non-existent file is not parsed"() {
        when:
        def report = ReportLoaderUtils.loadReport()

        then:
        report.isEmpty()
    }

}
