import {Injectable} from '@angular/core';
import {
  DefaultService,
  GetDashboardVulnerabilitiesRequestPayload,
  GetVulnerabilityServicesRequestPayload
} from "../../../generated/vulnerabilitytracer-manager";

@Injectable({
  providedIn: 'root'
})
export class DashboardService {

  constructor(private defaultService: DefaultService) {
  }

  public getDashboardVulnerabilities(from: Date, to: Date) {
    let payload: GetDashboardVulnerabilitiesRequestPayload = {
      fromDateTime: from.toISOString(),
      toDateTime: to.toISOString(),
    }

    return this.defaultService.getDashboardVulnerabilities(payload);
  }

  public getVulnerabilityServices(vulnerabilityExternalId: string, from: Date, to: Date) {
    let payload: GetVulnerabilityServicesRequestPayload = {
      vulnerabilityExternalId: vulnerabilityExternalId,
      fromDateTime: from.toISOString(),
      toDateTime: to.toISOString(),
    }

    return this.defaultService.getVulnerabilityServices(payload);
  }

}
