import argparse
from dataclasses import dataclass
from typing import Sequence


@dataclass
class Args:
    jaeger_url: str
    service_name: str


def build_args_parser() -> argparse.ArgumentParser:
    argparser = argparse.ArgumentParser(prog='tracecollector')

    argparser.add_argument('--jaeger-url', '-u',
                           help="Address of the Jaeger GRPC endpoint (default: %(default)s)",
                           type=str,
                           default="localhost:14250",
                           dest="jaeger_url",
                           )
    argparser.add_argument('service_name',
                           help="Name of the service, for which to fetch the traces",
                           type=str,
                           default="microservice",
                           nargs="?",
                           )
    return argparser


def parse_args(args: Sequence[str] | None = None):
    parser = build_args_parser()

    parser_result = parser.parse_args(args)

    return Args(
        jaeger_url=parser_result.jaeger_url,
        service_name=parser_result.service_name
    )

