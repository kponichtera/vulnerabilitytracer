version: 3

vars:
  KUBE_SERVICE: "{{.KUBE_SERVICE}}"
  KUBE_SERVICE_PORT: "{{.KUBE_SERVICE_PORT}}"

tasks:
  intercept:
    deps: [":connect"]
    cmd: "telepresence intercept {{.KUBE_SERVICE}} --port {{.KUBE_SERVICE_PORT}}:{{.KUBE_SERVICE_PORT}}"
  leave: "telepresence leave {{.KUBE_SERVICE}}"